<h2>캐시 (Cache)</h2>

> 캐시 : 메모리를 저장하는 임시 장소

<br/>

* 메모리와 CPU 간의 속도 차이를 완화하기 위해 메모리의 데이터를 미리 가져와 저장해두는 임시 장소
* **미리 가져오기 (prefetch)** : 필요한 데이터를 모아 한꺼번에 전달하는 버퍼의 일종으로 CPU가 앞으로 사용할 것으로 예상되는 데이터를 미리 가져다놓는다. 
* **캐시 히트** : 캐시에서 원하는 데이터를 찾아 바로 사용하는 것
* **캐시 미스** : 원하는 데이터가 없으면 메모리로 가서 데이터를 찾는 것
* **캐시 적중률** : 캐시 히트가 되는 비율 (일반적인 컴퓨터는 약 90%)

<br>

<img alt=cache src="https://github.com/danidanee/img/blob/master/%EC%BA%90%EC%8B%9C/%EC%BA%90%EC%8B%9C%EA%B5%AC%EC%A1%B0.png?raw=true"/>

<br/>

<br/>

<h3>캐시의 종류</h3>

**1. CPU 메모리**

- 대용량의 메인 메모리 접근을 빠르게 하기 위해 CPU 칩 내부나 바로 옆에 탑재하는 메모리
- 대부분의 CPU는 한개, 많게는 5~6개의 서로 다른 기능을 가진 CPU 캐시를 장착한다,
- 메모리 접근 속도가 늘어나는 것에 비해 CPU의 처리 속도가 훨씬 빠르게 늘어나고 있기 때문에, 용량은 작지만 속도가 빠른 CPU 캐시는 현재 마이크로프로세서의 성능에 직접적인 영향을 미친다.

<br/>

**2. 디스크 캐시 (디스크 버퍼)** 

* 디스크 제어와 외부와의 인터페이스를 위해 내장하는 작은 컴퓨터의 디스크에 입출력되는 데이터를 저장하는 작은 메모리
* 대개 2-32 MB 정도의 크기를 갖는다.
* 미리읽기, 속도조절, 쓰기 가속, 명령 큐의 용도로 사용한다.

<br/>

**3. 웹 브라우저 캐시**

* SW 적으로 사용하는 대표적인 예
* 앞으로 다시 방문할 것을 예상해 지우지 않은 데이터
* 로고, 버튼과 같은 자주 바뀌지 않는 데이터
* 방문했던 사이트의 데이터를 보관해 재방문 시 속도를 높이는 역할을 하지만, 너무 많은 데이터가 캐시에 보관되어 있으면 웹 브라우저의 속도를 떨어뜨릴 수 있으므로 가끔 청소를 하는 것이 좋다.

<br/>

**4. 기타 캐시**

* 신뢰성이 적은 네트워크에서, 네트워크 사이에 주고 받는 데이터를 캐시
* 인기 있는 웹 페이지의 캐시를 프록시 서버에 저장하여 웹 페이지 요청에 응답하게 함
* 검색 대상 사이트들의 내용을 캐시에 저장해 검색 엔진에 사용

<br/>

<br/>

<h3>캐시 적중률을 높이는 방법</h3>

**1. 캐시의 크기를 늘린다**

- 캐시의 크기가 커지면 더 많은 데이터를 미리 가져올 수 있어 캐시 적중률이 올라간다.
- 하지만 캐시는 가격이 비싸기 때문에 크기를 늘리는 데 한계가 있어 몇 MB 정도만 사용한다.

<br/>

**2. 지역성 이론**

* 앞으로 사용이 많이 사용될 데이터를 가져오는 것
* **시간적 지역성** : 특정 데이터가 한번 접근되었을 경우, 가까운 미래에 또 한번 데이터에 접근할 가능성이 높은 것
* **공간적 지역성** : 특정 데이터와 가까운 주소가 순서대로 접근되었을 가능성이 높은 것

<br/>

<br/>

<h3>캐시 데이터의 변경</h3>

* 캐시는 메모리에 있는 데이터를 임시로 가져온 것이기떄문에 캐시에 있는 데이터가 변경되면 메모리에 있는 원래 데이터를 변경해야된다
* 캐시의 변경된 데이터를 메모리에 반영하는 데에는 즉시 쓰기 방식과 지연 쓰기 방식이 있다.

<br/>

**1. 즉시 쓰기**

* 캐시에 있는 데이터가 변경되면 이를 즉시 메모리에 반영하는 방식
* 메모리와의 빈번한 데이터 전송으로 인해 성능이 느려진다.
* 메모리의 최신 값이 항상 유지되기떄문에 급작스러운 정전에도 데이터를 읽어버리지 않는다.

<br/>

**2. 지연 쓰기 (카피백)**

* 캐시에 있는 데이터가 변경되면 이를 즉시 메모리에 반영하는 것이 아니라 변경된 내용을 모아서 주기적으로 반영하는 방식
* 메모리와의 데이터 전송횟수가 줄어들어 시스템의 성능을 향상
* 메모리와 캐시메모리 사이의 불일치가 발생할 수도 있다.

<br/>

<img src="https://t1.daumcdn.net/cfile/tistory/275A584C54BDA6DB28?download"/>

<br/>

<br/>

<h3>레벨별 캐시</h3>

**1. L1 캐시**

* 일반적으로 CPU안에 내장되어 있으며 CPU에 가장 빠르게 접근하는 캐시
* 명령어 캐시는 명령어 레지스터와 연결되어 있고, 데이터 캐시는 데이터 레지스터와 연결되어 있다.
* 명령어 캐시나 데이터 캐시는 CPU 레지스터에 직접 연결되기 때문에 L1캐시라고 부른다.

<br/>

**2. L2 캐시**

* L1 캐시의 용량 제한 때문에 L1 캐시와 메인메모리 사이에 SRAM인 L2캐시를 두는 것

* 일반 캐시는 메모리와 연결되기 때문에 L2 캐시라고 부른다.

<br/>

**3. L3 캐시**

* 메인보드에 탑재해 성능을 올리기 위한 캐시

<br/>

<img src="https://t1.daumcdn.net/cfile/tistory/2631FF48580317B334"/>

<br/>

<br/>

<h3>redis</h3>

<br/>

* NoSQL & Cache 솔루션이며 메모리 기반으로 구성
* DB로 사용될 수 있으며 Cache로도 사용될 수 있는 기술
* 일반적으로 캐싱된 데이터는 만료시간 및 갱신 주기가 존재
* 싱글톤 패턴으로 구현

<br/>

<br/>

<출처>

[도서] 쉽게 배우는 운영 체제

[위키백과] [https://ko.wikipedia.org/wiki/%EC%BA%90%EC%8B%9C](https://ko.wikipedia.org/wiki/캐시)

[이미지] https://macnews.tistory.com/5022